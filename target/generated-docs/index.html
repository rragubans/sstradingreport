<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Michael Simons">
<title>biking2, Architecture and API</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>biking2, Architecture and API</h1>
<div class="details">
<span id="author" class="author">Michael Simons</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_disclaimer">Disclaimer</a></li>
<li><a href="#section-introduction-and-goals">1. Introduction and Goals</a>
<ul class="sectlevel2">
<li><a href="#_requirements_overview">1.1. Requirements Overview</a></li>
<li><a href="#_quality_goals">1.2. Quality Goals</a></li>
<li><a href="#_stakeholders">1.3. Stakeholders</a></li>
</ul>
</li>
<li><a href="#section-architecture-constraints">2. Architecture Constraints</a>
<ul class="sectlevel2">
<li><a href="#_technical_constraints">2.1. Technical Constraints</a></li>
<li><a href="#_organizational_constraints">2.2. Organizational Constraints</a></li>
<li><a href="#_conventions">2.3. Conventions</a></li>
</ul>
</li>
<li><a href="#section-system-scope-and-context">3. System Scope and Context</a>
<ul class="sectlevel2">
<li><a href="#_business_context">3.1. Business Context</a></li>
<li><a href="#_technical_context">3.2. Technical Context</a></li>
</ul>
</li>
<li><a href="#section-solution-strategy">4. Solution Strategy</a></li>
<li><a href="#section-building-block-view">5. Building Block View</a>
<ul class="sectlevel2">
<li><a href="#_whitebox_biking2_api">5.1. Whitebox biking2::api</a>
<ul class="sectlevel3">
<li><a href="#_bikes_blackbox">5.1.1. bikes (Blackbox)</a></li>
<li><a href="#_tracks_blackbox">5.1.2. tracks (Blackbox)</a></li>
<li><a href="#_trips_blackbox">5.1.3. trips (Blackbox)</a></li>
<li><a href="#_locations_blackbox">5.1.4. locations (Blackbox)</a></li>
<li><a href="#_bikingpictures_blackbox">5.1.5. bikingPictures (Blackbox)</a></li>
<li><a href="#_gallerypictures_blackbox">5.1.6. galleryPictures (Blackbox)</a></li>
</ul>
</li>
<li><a href="#_building_blocks_level_2">5.2. Building Blocks - Level 2</a>
<ul class="sectlevel3">
<li><a href="#_bikes_whitebox">5.2.1. bikes (Whitebox)</a></li>
<li><a href="#_tracks_whitebox">5.2.2. tracks (Whitebox)</a></li>
<li><a href="#_trips_whitebox">5.2.3. trips (Whitebox)</a></li>
<li><a href="#_locations_whitebox">5.2.4. locations (Whitebox)</a></li>
<li><a href="#_bikingpictures_whitebox">5.2.5. bikingPictures (Whitebox)</a></li>
<li><a href="#_gallerypictures_whitebox">5.2.6. galleryPictures (Whitebox)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#section-runtime-view">6. Runtime View</a>
<ul class="sectlevel2">
<li><a href="#_creating_new_tracks">6.1. Creating new tracks</a></li>
<li><a href="#_fetching_biking_pictures_from_em_daily_fratze_em">6.2. Fetching biking pictures from <em>Daily Fratze</em></a></li>
</ul>
</li>
<li><a href="#section-deployment-view">7. Deployment View</a></li>
<li><a href="#section-concepts">8. Concepts</a>
<ul class="sectlevel2">
<li><a href="#_domain_models">8.1. Domain Models</a></li>
<li><a href="#_persistency">8.2. Persistency</a></li>
<li><a href="#_user_interface">8.3. User Interface</a></li>
<li><a href="#_javascript_and_css_optimization">8.4. JavaScript and CSS optimization</a></li>
<li><a href="#_transaction_processing">8.5. Transaction Processing</a></li>
<li><a href="#_session_handling">8.6. Session Handling</a></li>
<li><a href="#_security">8.7. Security</a></li>
<li><a href="#_safety">8.8. Safety</a></li>
<li><a href="#_communications_and_integration">8.9. Communications and Integration</a></li>
<li><a href="#_plausibility_and_validity_checks">8.10. Plausibility and Validity Checks</a></li>
<li><a href="#_exception_error_handling">8.11. Exception/Error Handling</a></li>
<li><a href="#_logging_tracing">8.12. Logging, Tracing</a></li>
<li><a href="#_configurability">8.13. Configurability</a></li>
<li><a href="#_internationalization">8.14. Internationalization</a></li>
<li><a href="#_migration">8.15. Migration</a></li>
<li><a href="#_testability">8.16. Testability</a></li>
<li><a href="#_build_management">8.17. Build-Management</a></li>
</ul>
</li>
<li><a href="#section-design-decisions">9. Design Decisions</a>
<ul class="sectlevel2">
<li><a href="#_using_gpsbabel_for_converting_tcx_into_gpx_format">9.1. Using GPSBabel for converting TCX into GPX format</a></li>
<li><a href="#_using_local_file_storage_for_image_and_track_data">9.2. Using local file storage for image and track data</a></li>
</ul>
</li>
<li><a href="#section-quality-scenarios">10. Quality Scenarios</a>
<ul class="sectlevel2">
<li><a href="#_quality_tree">10.1. Quality Tree</a></li>
<li><a href="#_evaluation_scenarios">10.2. Evaluation Scenarios</a></li>
</ul>
</li>
<li><a href="#section-technical-risks">11. Technical Risks</a></li>
<li><a href="#section-glossary">12. Glossary</a></li>
<li><a href="#_about_this_template">About this template</a></li>
<li><a href="#api">Appendix A: Api</a>
<ul class="sectlevel2">
<li><a href="#bikes">Bikes</a>
<ul class="sectlevel3">
<li><a href="#listing-bikes">Listing bikes</a></li>
<li><a href="#_creating_a_bike">Creating a bike</a></li>
<li><a href="#_adding_milages_to_bikes">Adding milages to bikes</a></li>
<li><a href="#_adding_a_story_to_a_bike">Adding a story to a bike</a></li>
</ul>
</li>
<li><a href="#trips">Trips</a>
<ul class="sectlevel3">
<li><a href="#_creating_a_trip">Creating a trip</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<style>
.arc42help {font-size:small; width: 14px; height: 16px; overflow: hidden; position: absolute; right: 0px; padding: 2px 0px 3px 2px;}
.arc42help::before {content: "?";}
.arc42help:hover {width:auto; height: auto; z-index: 100; padding: 10px;}
.arc42help:hover::before {content: "";}
@media print {
	.arc42help {display:hidden;}
}
</style>
</div>
</div>
<div class="sect1">
<h2 id="_disclaimer"><a class="link" href="#_disclaimer">Disclaimer</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>I provide absolutely <strong>no guarantee</strong>, neither for the accuracy of this documentation nor for any property or feature of the software described here.</p>
</div>
<div class="paragraph">
<p>Do not use this software in critical situations or projects.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="section-introduction-and-goals"><a class="link" href="#section-introduction-and-goals">1. Introduction and Goals</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://biking.michael-simons.eu">biking.michael-simons.eu</a> is a project for</p>
</div>
<div class="ulist">
<ul>
<li>
<p>tracking my bike activities</p>
</li>
<li>
<p>evaluating technology</p>
</li>
<li>
<p>learn stuff</p>
</li>
<li>
<p>showcasing my skills</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For my information see <a href="http://info.michael-simons.eu/2014/02/20/developing-a-web-application-with-spring-boot-angularjs-and-java-8/">this blog post</a> as a starting point.</p>
</div>
<div class="paragraph">
<p>I&#8217;d like to thank all the people working at the Spring Eco System for doing their amazing work. Also a big thank you to Dr. Gernot Starke and Dr. Peter Hruschka for their inspiring workshop "Mastering Software Architecture" in Munich, December 2015. I took not only a nice <em>CPSA-F</em> certificate home, but really valuable and practical patterns for improving "my" software.</p>
</div>
<div class="paragraph">
<p>The blog post above had song lyrics from Nick Cave &amp; The Bad Seeds as intro (from “Push The Sky Away”) and for the architecture i have this:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Simplicity is a great virtue but it requires hard work to achieve it and education to appreciate it. And to make matters worse: complexity sells better.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Edsger W. Dijkstra<br>
<cite>On the nature of Computing Science</cite>
</div>
</div>
<div class="sect2">
<h3 id="_requirements_overview"><a class="link" href="#_requirements_overview">1.1. Requirements Overview</a></h3>
<div class="paragraph">
<div class="title">What is biking2?</div>
<p>The main purpose of <em>biking2</em> is keeping track of bicycles and their milages as well as converting <em>Garmin</em> <a href="https://en.wikipedia.org/wiki/Training_Center_XML"><em>Training Center XML</em> (tcx)</a> files to standard <a href="https://en.wikipedia.org/wiki/GPS_Exchange_Format"><em>GPS Exchange Format</em> (GPX)</a> files and storing them in an accessible way.</p>
</div>
<div class="paragraph">
<p>In addition <em>biking2</em> is used to study and evualate technology, patterns and frameworks. The functional requirements are simple enough to leave enough room for concentration on quality goals.</p>
</div>
<div class="ulist">
<div class="title">Main features</div>
<ul>
<li>
<p>Store bikes and their milages</p>
</li>
<li>
<p>Convert tcx files to GPX files and provide them in a library of tracks</p>
</li>
<li>
<p>Visualize those tracks on a map and provide a way to embed them in other webpages</p>
</li>
<li>
<p>Visualize biking activities with images</p>
</li>
<li>
<p>Optional, near real time, tracking of a biker</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application must only handle exactly one user with write permissions.</p>
</div>
<div class="paragraph">
<p>Most bike aficionados have problems understanding the question "why more than one bike?", the system should be able to keep track of everything between 2 and 10 bikes for one user, storing 1 total milage per bike and month. All milages per month, year and other metrics should be derived from this running total, so that the user only need to look at his odometer and enter the value.</p>
</div>
<div class="paragraph">
<p>The application should store an "unlimited" number of tracks.</p>
</div>
<div class="paragraph">
<p>The images should be collected from <a href="https://dailyfratze">Daily Fratze</a>, the source are all images that are tagged with "Radtour". In addition the user should be able to provide an "unlimted" number of "gallery pictures" together with a date and a short description.</p>
</div>
</div>
<div class="sect2">
<h3 id="_quality_goals"><a class="link" href="#_quality_goals">1.2. Quality Goals</a></h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Quality Goals</caption>
<colgroup>
<col style="width: 0%;">
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nr.</th>
<th class="tableblock halign-left valign-top">Quality</th>
<th class="tableblock halign-left valign-top">Motivation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Understandability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The functional requirements are simple enough to allow a simple, understandable solution that allows focus on learning about new Java 8 features, Spring Boot and AngularJS.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Efficiency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collecting milage data should be a no brainer: Reading the milage from an odometer and entering it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interoperability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The application should provide a simple API that allows access to new clients.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attractiveness</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collected milages should be presented in easy to grasp charts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The architecture should allow easy testing of all main building blocks.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_stakeholders"><a class="link" href="#_stakeholders">1.3. Stakeholders</a></h3>
<div class="paragraph">
<p>The following lists contains the most important personas for this application</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Stakeholders</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role/Name</th>
<th class="tableblock halign-left valign-top">Goal/Boundaries</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Developers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Developers who want to learn about developing modern applications with Spring Boot and various frontends, preferable using <em>Java 8</em> in the backend.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bikers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bike aficionados that are looking for a non-excel, self-hosted solution to keep track of their bikes and milages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Software Architects</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Looking for an <em>arc42</em> example; want to get ideas for their daily work.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael Simons</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improving his skills; wants to blog about Spring Boot; looking for a topic he can eventually hold a talk about; needed a project to try out new <em>Java 8</em> features.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-architecture-constraints"><a class="link" href="#section-architecture-constraints">2. Architecture Constraints</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The few constraints on this project are reflected in the final solution. This section shows them and if applicable, their motivation.</p>
</div>
<div class="sect2">
<h3 id="_technical_constraints"><a class="link" href="#_technical_constraints">2.1. Technical Constraints</a></h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. List of Technical Constraints</caption>
<colgroup>
<col style="width: 0%;">
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Constraint</th>
<th class="tableblock halign-left valign-top">Background and / or motivation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Software and programming constraints</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation in Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The application should be part of a Java 8 and Spring Boot show case. Clients can be implemented using various frameworks, languages and what not.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TC2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Third party software must be available under an compatible open source license and installable via a package manager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interested developer or architect should be able to check out the sources, compile and run the application without problems compiling or installing dependencies. All external dependencies should be available via the package manager of the operation system or at least through an installer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Operating System Constraints</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TC3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OS independent development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The application should be compilable on all 3 mayor operation systems (Mac OS X, Linux and Windows)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TC4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deployable to a Linux server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The application should be deployable through standard means on a Linux based server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Hardware Constraints</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TC5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory friendly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory can be limited (due to availability on a shared host or deployment to cloud based host). If deployed to a cloud based solution, every megabyte of memory costs.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_organizational_constraints"><a class="link" href="#_organizational_constraints">2.2. Organizational Constraints</a></h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. List of Organizational Constraints</caption>
<colgroup>
<col style="width: 0%;">
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Constraint</th>
<th class="tableblock halign-left valign-top">Background and / or motivation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael Simons</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OC2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time schedule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start in early 2014 with Spring Boot beta based prototypes running on Java 8 early access builds, first "release" version March 2014 together with the initial release of Java 8. Upgrade to a final Spring Boot release when they are available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OC3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDE independent project setup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No need to continue the editor and IDE wars. The project must be compilable on the command line via standard build tools. Due to <em>OC2</em> there is only one IDE supporting Java 8 features out of the box: <em>NetBeans 8</em> beta and release candidates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OC4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration and version control / management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private git repository with a complete commit history and a public master branch pushed to GitHub and linked a project blog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OC5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JUnit used for functional correctness and integration tests, using JaCoCo to ensure a high test coverage (at least 90%).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OC6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published under an Open Source license</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The source, including documentation, should be published as Open Source under the Apache 2 License.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_conventions"><a class="link" href="#_conventions">2.3. Conventions</a></h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. List of Conventions</caption>
<colgroup>
<col style="width: 0%;">
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Conventions</th>
<th class="tableblock halign-left valign-top">Background and / or motivation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Architecture documentation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structure based on the english arc42-Template in version 6.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding conventions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard Oracle Java Coding Conventions, tabs instead of spaces. Not enforced / checked but semi-automatic enforced using NetBeans formatting templates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">English. The project and the corresponding blog targets an international audience, so English should be used throughout the whole project.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-system-scope-and-context"><a class="link" href="#section-system-scope-and-context">3. System Scope and Context</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the environment and context of <em>biking2</em>. Who uses the system and on which other system does <em>biking2</em> depend.</p>
</div>
<div class="sect2">
<h3 id="_business_context"><a class="link" href="#_business_context">3.1. Business Context</a></h3>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/3.1_business-context(1).png" alt="3.1 business context(1)" width="640">
</div>
</div>
<div class="paragraph">
<div class="title">Biker</div>
<p>A passionate biker uses <em>biking2</em> to manage his bikes, milages, tracks and also visual memory (aka images) taken on tours etc. He also wants to embed his tracks as interactive maps on other websites.</p>
</div>
<div class="paragraph">
<div class="title">Daily Fratze</div>
<p><a href="https://dailyfratze.de">Daily Fratze</a> provides a list of images tagged with certain topics. <em>biking2</em> should collect all images for a given user tagged with "Theme/Radtour".</p>
</div>
<div class="paragraph">
<div class="title">GPSBabel</div>
<p>GPSBabel is a command line utility for manipulating GPS related files in various ways. <em>biking2</em> uses it to convert TCX into GPX files. The heaving lifting is done by GPSBabel and the resulting file will be managed by <em>biking2</em>.</p>
</div>
<div class="paragraph">
<div class="title">Arbitrary websites</div>
<p>The user may want to embed (or brag with) tracks on arbitrary websites. He only wants to paste a link to a track on a website that supports embedded content to embed a map with the given track.</p>
</div>
</div>
<div class="sect2">
<h3 id="_technical_context"><a class="link" href="#_technical_context">3.2. Technical Context</a></h3>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/3.2_technical-context(1).png" alt="3.2 technical context(1)" width="640">
</div>
</div>
<div class="paragraph">
<p><em>biking2</em> is broken into 2 main components:</p>
</div>
<div class="paragraph">
<div class="title">Backend (biking2::api)</div>
<p>The api runs on a supported application server, using either an embedded container or an external container. It communicates via operating system processes with GPSBabel on the same server.</p>
</div>
<div class="paragraph">
<p>The connection to <em>Daily Fratze</em> is http based RSS-feed. The feed is paginated and provides <strong>all</strong> images with the given tag but older images may not be available any more when the owner decided to add a digital expiry.</p>
</div>
<div class="paragraph">
<p>Furthermore <em>biking2</em> provides an <a href="http://oembed.com">oEmbed</a> interface for all tracks stored in the system. Arbitrary websites supporting that protocol can request embeddable content over http knowing only a link to the track without working on the track or map apis themselves.</p>
</div>
<div class="paragraph">
<div class="title">Frontend (biking2::spa and biking2::bikingFX)</div>
<p>The frontend is implemented with two different components, the biking2::spa (Single Page Application) is part of this package. The spa runs in any modern web browser and communicates via http with the api.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Business interface</th>
<th class="tableblock halign-left valign-top">channel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format conversions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System processes, command line interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection of biking pictures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSS feed over Internet (http)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embeddable content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">oEmbed format over Internet (http)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API for business functions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet (http)</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-solution-strategy"><a class="link" href="#section-solution-strategy">4. Solution Strategy</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>At the core of <em>biking2</em> is a simple yet powerful domain model based on a few entities of which a "Bike" and it&#8217;s "Milage" are the most important.</p>
</div>
<div class="paragraph">
<p>Although data centric, the application resigns from using too much SQL for creating reports, summaries and such but tries to achieve that with new Java 8 features around streams, lambdas and map/reduce functions.</p>
</div>
<div class="paragraph">
<p>Building the application with Spring Boot is an obvious choice as one of the main <a href="#_quality_goals">quality goals</a> is learning about it. But furthermore using Spring Boot as a "framework" for Spring Framework allows concentration on the business logic. On the one hand there is no need to understand a complex XML configuration and on the other hand all building blocks are still put together using dependency injection.</p>
</div>
<div class="paragraph">
<p>Regarding dependency injection and testability: All injection should be done via constructor injection, setter injection is only allowed when there&#8217;s no other technical way. This way units under tests can only be correctly instantiated. Otherwise one tends to forget collaborators or even worse: 20 injected attributes may not hurt, but a constructor with 20 parameters will. This hopefully prevents centralized god classes that control pretty much every other aspect of the application.</p>
</div>
<div class="paragraph">
<p>Spring Boot applications can be packaged as single, fat jar files. Since Spring Boot 1.3 those files contain a startup script and can be directly linked to <em>/etc/init.d</em> on a standard Linux systems which serves <a href="#_technical_constraints">[TC4]</a>.</p>
</div>
<div class="paragraph">
<p>Interoperability will be achieved by using JSON over simple http protocol for the main API. Security is not the main focus of this application. It should be secure enough to prevent others from tempering with the data, confidentiality is not a main concern (read: passwords can be transmitted in plain over http).</p>
</div>
<div class="paragraph">
<p>The internal single page application shall be implemented using AngularJS. The deployable artifact will contain this application so there is no need for hosting a second webserver for the static files.</p>
</div>
<div class="paragraph">
<p>For real time tracking the MQTT protocol will be used which is part of Apache ActiveMQ, supported out of the box by Spring Messaging.</p>
</div>
<div class="paragraph">
<p>Graphing should not be implemented here but instead the <a href="http://www.highcharts.com">Highcharts</a> library should be used. The configuration for all charts should be computed server side.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="section-building-block-view"><a class="link" href="#section-building-block-view">5. Building Block View</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The application packaged as <em>biking2.jar</em> contains two (the api and the spa) of three main parts, as shown in the <a href="#_business_context">Business Context</a>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.0_level0.png" alt="5.0 level0">
</div>
</div>
<div class="paragraph">
<p>From those two we have a closer look at the api only. For details regarding the structure of an AngularJS 1.2.x application, have a look at their <a href="https://code.angularjs.org/1.2.28/docs/guide">developers guide</a>.</p>
</div>
<div class="sect2">
<h3 id="_whitebox_biking2_api"><a class="link" href="#_whitebox_biking2_api">5.1. Whitebox biking2::api</a></h3>
<div class="paragraph">
<p>The following diagram shows the main building blocks of the system and their interdependencies:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.1_level1-biking_api.png" alt="5.1 level1 biking api">
</div>
</div>
<div class="paragraph">
<p>I used <em>functional decomposition</em> to separate responsibilities. The single parts of the api are all encapsulated in their own components, represented as Java packages.</p>
</div>
<div class="paragraph">
<p>All components depend on a standard JPA EntityManager and some on local file storage. I won&#8217;t go into detail for those blackboxes.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Contained blackboxes</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. biking2::api building blocks</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_bikes_blackbox">bikes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managing bikes, adding monthly milages, computing statistics and generating charts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_tracks_blackbox">tracks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uploading tracks (TCX files), converting to GPX, providing an oEmbed interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_trips_blackbox">trips</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managing assorted trips.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_locations_blackbox">locations</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT and STOMP interface for creating new locations and providing them in real time on websockets via stomp.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_bikingpictures_blackbox">bikingPictures</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reading biking pictures from an RSS feed provided by <em>Daily Fratze</em> and providing an API to them.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_gallerypictures_blackbox">galleryPictures</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uploading and managing arbitrary pictures</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. biking2::Interfaces</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bikes Api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST api containing methods for reading, adding and decommissioning bikes and for adding milages to single bikes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">charts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methods for retrieving statistics as fully setup chart definitions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tracks Api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST api for uploading and reading TCX files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trips Api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST api for adding new trips.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">oEmbed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP based oEmbed interface, generating URLs with embeddable content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Real time locations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WebSocket / STOMP based interface on which new locations are published.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Real time location updates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT interface to which MQTT compatible systems like <a href="http://owntracks.org">OwnTracks</a> can offer location updates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSS feed reader</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Needs an <em>Daily Fratze</em> OAuth token for accessing a RSS feed containing biking pictures which are than grabbed from <em>Daily Fratze</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">galleryPictures Api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST api for uploading and reading arbitrary image files (pictures related to biking).</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_bikes_blackbox"><a class="link" href="#_bikes_blackbox">5.1.1. bikes (Blackbox)</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Intent/Responsibility</dt>
<dd>
<p><code>bikes</code> provides the external API for reading, creating and manipulating bikes and their milages as well as computing statistics and generating charts.</p>
</dd>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/bikes/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains all methods for manipulating bikes and their milages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/charts/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains all methods for generating charts</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The <code>bikes</code> module and all of its dependencies are contained inside the Java package <code>ac.simons.biking2.bikes</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_tracks_blackbox"><a class="link" href="#_tracks_blackbox">5.1.2. tracks (Blackbox)</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Intent/Responsibility</dt>
<dd>
<p><code>tracks</code> manages file uploads (TCX files), converts them to GPX files and computes their surrounding rectangle (envelope) using <em>GPSBabel</em>. It also provides the <em>oEmbed</em> interface that resolves URLS to embeddable tracks.</p>
</dd>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/tracks/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains all methods for manipulating tracks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/api/oembed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resolve track URLs to embeddable tracks (content)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/tracks/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embeddable track content</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The <code>tracks</code> module and all of its dependencies are contained inside the Java package <code>ac.simons.biking2.tracks</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_trips_blackbox"><a class="link" href="#_trips_blackbox">5.1.3. trips (Blackbox)</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Intent/Responsibility</dt>
<dd>
<p><code>trips</code> manages distances that have been covered on single days without relationships to bikes.</p>
</dd>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/trips/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains all methods for manipulating trips</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The <code>trips</code> module and all of its dependencies are contained inside the Java package <code>ac.simons.biking2.trips</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_locations_blackbox"><a class="link" href="#_locations_blackbox">5.1.4. locations (Blackbox)</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Intent/Responsibility</dt>
<dd>
<p><code>locations</code> stores locations with timestamps in near realtime and provides access to locations for the last 30 minutes.</p>
</dd>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/locations/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For retrieving all loccations in the last 30 minutes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WebSocket / STOMP topic <code>/topic/currentLocation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface for getting notifcation on new locations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Listens for new locations coming in via MQTT in <a href="http://owntracks.org/booklet/tech/json/">OwnTracks format</a></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The <code>locations</code> module and all of its dependencies are contained inside the Java package <code>ac.simons.biking2.tracker</code>. The module is configured through <code>ac.simons.biking2.config.TrackerConfig</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_bikingpictures_blackbox"><a class="link" href="#_bikingpictures_blackbox">5.1.5. bikingPictures (Blackbox)</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Intent/Responsibility</dt>
<dd>
<p><code>bikingPictures</code> is used for regularly checking a RSS feed from <em>Daily Fratze</em> collecting new images and storing them locally. It also provides an API for getting all collected images.</p>
</dd>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSS Feed reader</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides access to the <em>Daily Fratze</em> RSS Feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Image reader</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides access to images hosted on <em>Daily Fratze</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/bikingPictures/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains all methods for accessing biking pictures</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The <code>bikingPictures</code> module and all of its dependencies are contained inside the Java package <code>ac.simons.biking2.bikingPictures</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_gallerypictures_blackbox"><a class="link" href="#_gallerypictures_blackbox">5.1.6. galleryPictures (Blackbox)</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Intent/Responsibility</dt>
<dd>
<p><code>galleryPictures</code> manages file uploads (images). It stores them locally and provides an RSS interface for getting metadata and image data.</p>
</dd>
<dt class="hdlist1">Interfaces</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST interface <code>/api/galleryPictures/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains all methods for adding and reading arbitrary pictures</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The <code>galleryPictures</code> module and all of its dependencies are contained inside the Java package <code>ac.simons.biking2.galleryPictures</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_building_blocks_level_2"><a class="link" href="#_building_blocks_level_2">5.2. Building Blocks - Level 2</a></h3>
<div class="sect3">
<h4 id="_bikes_whitebox"><a class="link" href="#_bikes_whitebox">5.2.1. bikes (Whitebox)</a></h4>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.2_level2-bikes.png" alt="5.2 level2 bikes">
</div>
</div>
<div class="paragraph">
<p>The <code>BikeRepository</code> is a Spring Data JPA based repository for <code>BikeEntities</code>. The <code>BikeController</code> and the <code>ChartsController</code> access it to retrieve and store instances of <code>BikeEntity</code> and provide external interfaces.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Contained blackboxes</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">highcharts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains logic for generating configurations and definitions for <a href="http://www.highcharts.com">Highcharts</a> on the server side.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_tracks_whitebox"><a class="link" href="#_tracks_whitebox">5.2.2. tracks (Whitebox)</a></h4>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.2_level2-tracks.png" alt="5.2 level2 tracks">
</div>
</div>
<div class="paragraph">
<p>The <code>TrackRepository</code> is a Spring Data JPA based repository for <code>TrackEntities</code>. The <code>TracksController</code> and the <code>OembedController</code> access it to retrieve and store instances of <code>TrackEntity</code> and provide external interfaces.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Contained blackboxes</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gpx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated <em>JAXB</em> classes for parsing GPX files. Used by the <code>TracksController</code> to retrieve the surrounding rectangle (envelope) for new tracks.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_trips_whitebox"><a class="link" href="#_trips_whitebox">5.2.3. trips (Whitebox)</a></h4>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.2_level2-trips.png" alt="5.2 level2 trips">
</div>
</div>
<div class="paragraph">
<p>The <code>AssortedTripRepository</code> is a Spring Data JPA based repository for <code>AssortedTripEntities</code>. The <code>TripsController</code> accesses it to retrieve and store instances of <code>TrackEntity</code> and provide external interfaces.</p>
</div>
</div>
<div class="sect3">
<h4 id="_locations_whitebox"><a class="link" href="#_locations_whitebox">5.2.4. locations (Whitebox)</a></h4>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.2_level2-locations.png" alt="5.2 level2 locations">
</div>
</div>
<div class="paragraph">
<p>Locations are stored and read via a Spring Data JPA based repository named <code>LocationRepository</code>. This repository is only accessed through the <code>LocationService</code>. The <code>LocationService</code> provides real time updates for connected clients through a <code>SimpMessagingTemplate</code> and the <code>LocationController</code> uses the service to provide access to all locations created within the last 30 minutes.</p>
</div>
<div class="paragraph">
<p>New locations are created through the service either through a REST interface in form of the <code>LocationController</code> or via a <code>MessageListener</code> on a MQTT channel.</p>
</div>
</div>
<div class="sect3">
<h4 id="_bikingpictures_whitebox"><a class="link" href="#_bikingpictures_whitebox">5.2.5. bikingPictures (Whitebox)</a></h4>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.2_level2-bikingPictures.png" alt="5.2 level2 bikingPictures">
</div>
</div>
<div class="paragraph">
<p>A Spring Data JPA repository <code>BikingPicturesRepository</code> is used for all access to <code>BikingPictureEntities</code>, the external REST api for reading pictures is implemented with <code>BikingPicturesController</code>. The RSS feed is read from <code>FetchBikingPicturesJob</code> by using a JAXBContext "rss". The URLs to the image files which may are protected by various means are provided to the job via a <code>DailyFratzeProvider</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Contained blackboxes</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated <em>JAXB</em> classes for parsing RSS feeds. Used by the <code>FetchBikingPicturesJob</code> to read the contents of an RSS feed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_gallerypictures_whitebox"><a class="link" href="#_gallerypictures_whitebox">5.2.6. galleryPictures (Whitebox)</a></h4>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/5.2_level2-galleryPictures.png" alt="5.2 level2 galleryPictures">
</div>
</div>
<div class="paragraph">
<p>The <code>GalleryPictureRepository</code> is a Spring Data JPA based repository for <code>GalleryPictureEntities</code>. The <code>GalleryController</code> accesses it to retrieve and store instances of <code>GalleryPictureEntity</code> and provide external interfaces.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-runtime-view"><a class="link" href="#section-runtime-view">6. Runtime View</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>User interaction with <em>biking2</em> and error handling is pretty basic and simple.</p>
</div>
<div class="paragraph">
<p>I picked up two uses cases where an actual runtime view is interesting:</p>
</div>
<div class="sect2">
<h3 id="_creating_new_tracks"><a class="link" href="#_creating_new_tracks">6.1. Creating new tracks</a></h3>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/6.1_creating-new-tracks.png" alt="6.1 creating new tracks">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fetching_biking_pictures_from_em_daily_fratze_em"><a class="link" href="#_fetching_biking_pictures_from_em_daily_fratze_em">6.2. Fetching biking pictures from <em>Daily Fratze</em></a></h3>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/6.2_fetching-biking-pictures-from-dailyfratze.png" alt="6.2 fetching biking pictures from dailyfratze">
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-deployment-view"><a class="link" href="#section-deployment-view">7. Deployment View</a></h2>
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/7_deployment.png" alt="7 deployment">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Deployment nodes and artifact</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Node / artifact</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2 development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Where <em>biking2</em> development takes place, standard computer with JDK 8, Maven and GPSBabel installed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uberspace host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A host on <a href="https://uberspace.de">Uberspace</a> where biking2.jar runs on a <a href="http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html">Server JRE</a> with restricted memory usage.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.jar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A "fat jar" containing all Java dependencies and a loader so that the Jar is runnable either as jar file or as a service script (on Linux hosts).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A recent browser to access the AngularJS biking2 single page application. All major browsers (Chrome, Firefox, Safari, IE / Edge) should work.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="section-concepts"><a class="link" href="#section-concepts">8. Concepts</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_domain_models"><a class="link" href="#_domain_models">8.1. Domain Models</a></h3>
<div class="paragraph">
<p><em>biking2</em> is datacentric application, therefore everything is based around an Entity Relationship Diagram (ER-Diagram):</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/8.1_er-diagram.png" alt="8.1 er diagram">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Tables</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bikes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores the bikes. Contains dates when the bike was bought and decomissioned, an optional link, color for the charts and also an auditing column when a row was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">milages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores milages for a bike (when and how much)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tracks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores GPS tracks recorded and uploaded with an optional description. For each day the track names must be unique. The columns <em>minlat</em>, <em>minlon</em>, <em>maxlat</em> and <em>maxlon</em> store the encapsulating rectangle for the track. The <em>type</em> column is constrainted to "biking" and "running".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">assorted_trips</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores a date and a distance on that day. Multiple distances per day are allowed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">locations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores arbitrary locations (latitude and longitude based) for given timestamp with an optional description.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking_pictures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores pictures collected from <em>Daily Fratze</em> together with their original date of publication, their unique external id and a link to the page the picture originaly appeared.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gallery_pictures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores all pictures uploaded by the user with a description and the date the picture was taken. The <em>filename</em> column contains a single, computed filename without path information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Those tables are mapped to the following domain model:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/8.1_domain-model.png" alt="8.1 domain model">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Domain model</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BikeEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A bike was bought on a given date and can be decommisioned. It has a color and an optional link to an arbitrary website. It may or may not have milages recorded. It has some important functions, see <a href="#BikingEntityMethods">Important business methods on BikeEntity</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MilageEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A milage is part of a bike. For each bike one milage per month can be recored. The milage is the combination of it&#8217;s recording date, the amount and the bike.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TrackEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The representation of <em>tracks</em> contents. The type is an enumeration. Notable public operations are <code>getPrettyId</code> (computes a "pretty" id based on the instances id) and <code>getTrackFile</code> (generates a reference to the GPS track file in the passed data storage directory).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BikingPictureEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For handling pictures collected from <em>Daily Fratze</em>. The BikingPictureEntity parses the image link on construction the retrieve the unique, external id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GalleryPictureEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A bean for handling the pictures uploaded by the user. <code>prePersist</code> fills the <code>createdAt</code> attribute prior to inserting into the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AssortedTripEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This entity captures a distance which was covered on at a certain date and can used for keeping track on trips with bikes not stored in this application for example.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LocationEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used in the tracker module for working with real time locations.</p></td>
</tr>
</tbody>
</table>
<table id="BikingEntityMethods" class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Important business methods on BikeEntity</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>decommission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decommissions a bike on a given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addMilage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds a new milage for a given date and returns it. The milage will only be added if the date is after the date the last milage was added and if the amount is greater than the last milage.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getPeriods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets all monthly periods in which milages have been recorded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getMilage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets the total milage of this bike.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getLastMilage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets the last milage recorded. In most cases the same as <code>getMilage</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getMilageInPeriod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets the milage in a given period.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getMilagesInYear</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets all milages in a year as an array (of months).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getMilageInYear</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets the total milage in a given year.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_persistency"><a class="link" href="#_persistency">8.2. Persistency</a></h3>
<div class="paragraph">
<p><em>biking2</em> uses an <a href="http://www.h2database.com/html/main.html">H2</a> database for storing relational data and the file system for binary image files and large ascii files (especially all GPS files).</p>
</div>
<div class="paragraph">
<p>During development and production the H2 database is retained and not in-memory based. The location of this file is configured through the <code>biking2.database-file</code> property and the default during development is <code>./var/dev/db/biking-dev</code> relative to the working directory of the VM.</p>
</div>
<div class="paragraph">
<p>All access to the database goes through JPA using Hibernate as provider. See the <a href="#_domain_models">Domain Models</a> for all entities used in the application.</p>
</div>
<div class="paragraph">
<p>The JPA Entity Manager isn&#8217;t accessed directly but only through the facilities offered by Spring Data JPA, that is through repositories only.</p>
</div>
<div class="paragraph">
<p>All data stored as files is stored relative to <code>biking2.datastore-base-directory</code> which defaults to <code>./var/dev</code>. Inside are 3 directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bikingPictures</code>: Contains all pictures collected from <em>Daily Fratze</em></p>
</li>
<li>
<p><code>galleryPictures</code>: Contains all uploaded pictures</p>
</li>
<li>
<p><code>tracks</code>: Contains uploaded GPS data and the result of converting TCX files into GPX files</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_user_interface"><a class="link" href="#_user_interface">8.3. User Interface</a></h3>
<div class="paragraph">
<p>The default user interface for <em>biking2</em> and packaged within the final artifact is a Single Page Application written in JavaScript using <em>Angular JS</em> together with a very default <em>Bootstrap</em> template.</p>
</div>
<div class="paragraph">
<p>For using the realtime location update interface, choose one of the many MQTT clients outthere.</p>
</div>
<div class="paragraph">
<p>There is a second user interface written in Java called <a href="http://info.michael-simons.eu/2014/10/22/getting-started-with-javafx-8-developing-a-rest-client-application-from-scratch/">bikingFX</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javascript_and_css_optimization"><a class="link" href="#_javascript_and_css_optimization">8.4. JavaScript and CSS optimization</a></h3>
<div class="paragraph">
<p>JavaScript and CSS dependencies are managed through Maven dependencies in form of <a href="http://www.webjars.org">webjars</a> wherever possible without the need for brew, npm, bower and the like.</p>
</div>
<div class="paragraph">
<p>Then <em>biking2</em> uses <a href="http://alexo.github.io/wro4j/">wro4j</a> together with a small <a href="https://github.com/michael-simons/wro4j-spring-boot-starter">Spring Boot Starter</a> to optimize JavaScript and CSS web resources.</p>
</div>
<div class="paragraph">
<p>wro4j provides a model like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;groups xmlns="http://www.isdc.ro/wro"&gt;
    &lt;!-- Dependencies for the full site --&gt;
    &lt;group name="biking2"&gt;
    	&lt;group-ref&gt;osm&lt;/group-ref&gt;

    	&lt;css minimize="false"&gt;/webjars/bootstrap/@bootstrap.version@/css/bootstrap.min.css&lt;/css&gt;
    	&lt;css&gt;/css/stylesheet.css&lt;/css&gt;

    	&lt;js minimize="false"&gt;/webjars/jquery/@jquery.version@/jquery.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/bootstrap/@bootstrap.version@/js/bootstrap.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/momentjs/@momentjs.version@/min/moment-with-locales.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/angular-file-upload/@angular-file-upload.version@/angular-file-upload-html5-shim.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/angularjs/@angularjs.version@/angular.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/angularjs/@angularjs.version@/angular-route.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/angular-file-upload/@angular-file-upload.version@/angular-file-upload.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/angular-ui-bootstrap/@angular-ui-bootstrap.version@/ui-bootstrap.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/angular-ui-bootstrap/@angular-ui-bootstrap.version@/ui-bootstrap-tpls.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/highcharts/@highcharts.version@/highcharts.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/highcharts/@highcharts.version@/highcharts-more.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/sockjs-client/@sockjs-client.version@/sockjs.min.js&lt;/js&gt;
    	&lt;js minimize="false"&gt;/webjars/stomp-websocket/@stomp-websocket.version@/stomp.min.js&lt;/js&gt;

    	&lt;js&gt;/js/app.js&lt;/js&gt;
    	&lt;js&gt;/js/controllers.js&lt;/js&gt;
    	&lt;js&gt;/js/directives.js&lt;/js&gt;
    &lt;/group&gt;
&lt;/groups&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This model file is filtered by the Maven build, version placeholders will be replaced and all resources, in webjars as well as inside the filesystem, will be available as <code>biking.css</code> and <code>biking.js</code>.</p>
</div>
<div class="paragraph">
<p>How those files are optimized, minimized or otherwise processed is up to wro4js configuration, but minification can be turned of during development.</p>
</div>
</div>
<div class="sect2">
<h3 id="_transaction_processing"><a class="link" href="#_transaction_processing">8.5. Transaction Processing</a></h3>
<div class="paragraph">
<p><em>biking2</em> relies on Spring Boot to create all necessary beans for handling local transactions within the JPA EntityManager. <em>biking2</em> does not support distributed transactions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_session_handling"><a class="link" href="#_session_handling">8.6. Session Handling</a></h3>
<div class="paragraph">
<p><em>biking2</em> only provides a stateless public API, there is no session handling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_security"><a class="link" href="#_security">8.7. Security</a></h3>
<div class="paragraph">
<p><em>biking2</em> offers security for its API endpoints only via <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP basic access authentication</a> and in case of the MQTT module with MQTTs default security model. Security can be increased by running the application behind a SSL proxy or configuring SSL support in the embedded Tomcat container.</p>
</div>
<div class="paragraph">
<p>For the kind of data managed here it&#8217;s an agreed tradeoff to keep the application simple. See also <a href="#_safety">Safety</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_safety"><a class="link" href="#_safety">8.8. Safety</a></h3>
<div class="paragraph">
<p>No part of the system has life endangering aspect.</p>
</div>
</div>
<div class="sect2">
<h3 id="_communications_and_integration"><a class="link" href="#_communications_and_integration">8.9. Communications and Integration</a></h3>
<div class="paragraph">
<p><em>biking2</em> uses an internal Apache ActiveMQ broker on the same VM as the application for providing STOMP channels and a MQTT transport. This broker is volatile, messages are not persisted during application restarts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plausibility_and_validity_checks"><a class="link" href="#_plausibility_and_validity_checks">8.10. Plausibility and Validity Checks</a></h3>
<div class="paragraph">
<p>Datatypes and ranges are checked via <a href="http://beanvalidation.org/1.0/spec/">JSR-303</a> annotations on classes representing the <a href="#_domain_models">Domain Models</a>. Those classes are directly bound to external REST interfaces.</p>
</div>
<div class="paragraph">
<p>There are three important business checks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Bikes which have been decommissioned cannot be modified (i.e. they can have no new milages): Checked in <code>BikesController</code>.</p>
</li>
<li>
<p>For each unique month only one milage can be added to a bike. Checked in the <code>BikeEntity</code>.</p>
</li>
<li>
<p>A new milage must be greater than the last one. Also checked inside <code>BikeEntity</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_exception_error_handling"><a class="link" href="#_exception_error_handling">8.11. Exception/Error Handling</a></h3>
<div class="paragraph">
<p>Errors handling to inconsistent data (in regard to the data models constraint) as well as failures to <a href="#_plausibility_and_validity_checks">validation</a> are mapped to HTTP errors. Those errors are handled by the frontends controller code. Technical errors (hardware, database etc.) are not handled and may lead to application failure or lost data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging_tracing"><a class="link" href="#_logging_tracing">8.12. Logging, Tracing</a></h3>
<div class="paragraph">
<p>Spring Boot configures logging per default to standard out. The default <a href="#_configurability">configuration</a> isn&#8217;t change in that regard, so all framework logging (especially Spring and Hiberate) go to standard out in standard format and can be grabbed or ignored via OS specific means.</p>
</div>
<div class="paragraph">
<p>All business components use <code>java.util.logging</code> facilities which are configured through the Spring Boot runtime.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configurability"><a class="link" href="#_configurability">8.13. Configurability</a></h3>
<div class="paragraph">
<p>Spring Boot offers a plethora of configuration options, those are just the main options to configure Spring Boot and available starters: <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html">Common application properties</a>.</p>
</div>
<div class="paragraph">
<p>The default configuration is available in <code>src/main/resources/application.properties</code>. During development those properties are merged with <code>src/main/resources/application-dev.properties</code>. Additional properties can be added through system environment or through an <code>application-*.properties</code> in the current JVM directory.</p>
</div>
<div class="paragraph">
<p>During tests an additional <code>application-test.properties</code> can be used to add or overwrite additional properties or values.</p>
</div>
<div class="paragraph">
<p>Those are the <em>biking2</em> specific properties:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. biking2 specific configuration properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.color-of-cumulative-graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Color of the cumulative line graph</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.dailyfratze-access-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">n/a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An OAuth access token for <em>Daily Fratze</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.datastore-base-directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${user.dir}/var/dev</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for storing files (tracks and images)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.fetch-biking-picture-cron</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 0 */8 * * *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A cron expression for configuring the <code>FetchBikingPicturesJob</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.home.longitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.179489185520004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longitude of the home coordinate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.home.latitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50.75144902272457</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latitude of the home coordinate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.connector.proxyName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">n/a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a proxy if <em>biking2</em> runs behind one</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.connector.proxyPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of a proxy if <em>biking2</em> runs behind one</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.gpsBabel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/opt/local/bin/gpsbabel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fully qualified path to the <em>GPSBabel</em> binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.scheduled-thread-pool-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thread pool size for the job pool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.tracker.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localhost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host on which the tracker (MQTT channel) should listen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.tracker.stompPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2307</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STOMP port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.tracker.mqttPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4711</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.tracker.username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${security.user.name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username for the MQTT channel</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.tracker.password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${security.user.password}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password for the MQTT channel</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">biking2.tracker.device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">iPhone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the OwnTracks device</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_internationalization"><a class="link" href="#_internationalization">8.14. Internationalization</a></h3>
<div class="paragraph">
<p>Only supported language is English. There is no hook for doing internationalization in the frontend and there are no plans for creating one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_migration"><a class="link" href="#_migration">8.15. Migration</a></h3>
<div class="paragraph">
<p><em>biking2</em> replaced a Ruby application based on the <em>Sinatra</em> framework. Data was stored in a SQLite database which has been migrated by hand to the H2 database.</p>
</div>
</div>
<div class="sect2">
<h3 id="_testability"><a class="link" href="#_testability">8.16. Testability</a></h3>
<div class="paragraph">
<p>The project contains a JUnit tests in the standard location of a Maven project. At the time of writing those tests covers &gt;95% of the code written. Tests must be executed during build and should not be skipped.</p>
</div>
</div>
<div class="sect2">
<h3 id="_build_management"><a class="link" href="#_build_management">8.17. Build-Management</a></h3>
<div class="paragraph">
<p>The application can be build with Maven without external dependencies outside Maven. To run all tests <em>gpsbabel</em> must be on the path.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-design-decisions"><a class="link" href="#section-design-decisions">9. Design Decisions</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_using_gpsbabel_for_converting_tcx_into_gpx_format"><a class="link" href="#_using_gpsbabel_for_converting_tcx_into_gpx_format">9.1. Using GPSBabel for converting TCX into GPX format</a></h3>
<div class="paragraph">
<div class="title">Problem</div>
<p>Popular JavaScript mapping frameworks provide easy ways to include geometries from GPX data on maps. Most Garmin devices however record track data in TCX format, so i needed a way to convert TCX to GPX. Both formats are relatively simple and in case of GPX good documented formats.</p>
</div>
<div class="ulist">
<div class="title">Constraints</div>
<ul>
<li>
<p>Conversion should handle TCX files with single tracks, laps and additional points without problem</p>
</li>
<li>
<p>Focus for this project has been on developing a modern application backend for an AngularJS SPA, not parsing GPX data</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Assumptions</div>
<ul>
<li>
<p>Using an external, non Java based tool makes it harder for people who just want to try out this application</p>
</li>
<li>
<p>Although good documented, both file types can contain varieties for informations (routes, tracks, waypoints) which makes it hard to parse</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Considered Alternatives</div>
<ul>
<li>
<p>Writing my own converter</p>
</li>
<li>
<p>Using existing swiss army knife for GPS data: <a href="http://www.gpsbabel.org">GPSBabel</a></p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>GPSBabel converts waypoints, tracks, and routes between popular GPS receivers such as Garmin or Magellan and mapping programs like Google Earth or Basecamp. Literally hundreds of GPS receivers and programs are supported. It also has powerful manipulation tools for such data. such as filtering duplicates points or simplifying tracks. It has been downloaded and used tens of millions of times since it was first created in 2001, so it&#8217;s stable and trusted</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<div class="title">Decision</div>
<p><em>biking2</em> uses GPSBabel for the heavy lifting of GPS related data. The project contains a big README stating that GPSBabel must be installed. GPSBabel can be installed on Windows with an installer and on must Linux systems through the official packet manager. Under OS X it is available via MacPorts or Homebrew.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_local_file_storage_for_image_and_track_data"><a class="link" href="#_using_local_file_storage_for_image_and_track_data">9.2. Using local file storage for image and track data</a></h3>
<div class="paragraph">
<div class="title">Problem</div>
<p><em>biking2</em> needs to store "large" objects: Image data (biking and gallery pictures) as well as track data.</p>
</div>
<div class="ulist">
<div class="title">Considered Alternatives</div>
<ul>
<li>
<p>Using some kind of Cloud storage like S3</p>
</li>
<li>
<p>Using local file system</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Decision</div>
<p>I opted for local file system because i didn&#8217;t want to put much effort into evaluating cloud services. If <em>biking2</em> should runnable in cloud based setup, one has to create an abstraction over the local filesystem currently used.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-quality-scenarios"><a class="link" href="#section-quality-scenarios">10. Quality Scenarios</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_quality_tree"><a class="link" href="#_quality_tree">10.1. Quality Tree</a></h3>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="img/10_quality_tree.png" alt="10 quality tree">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_evaluation_scenarios"><a class="link" href="#_evaluation_scenarios">10.2. Evaluation Scenarios</a></h3>
<div class="paragraph">
<div class="title">Testability / Coverage</div>
<p>By using <em>JaCoCo</em> during <a href="http://info.michael-simons.eu/2014/05/22/jacoco-maven-and-netbeans-8-integration/">development and during the build process</a> ensure a code coverage of at least 95%.</p>
</div>
<div class="paragraph">
<div class="title">Testability / Independent from external services</div>
<p>The architecture should be designed in such a way that algorithms depending on external services can be tested without having the external service available. That is: All external dependencies should be mockable.</p>
</div>
<div class="paragraph">
<p>Example: <code>FetchBikingPicturesJob</code> needs a resource containing a RSS feed. By delegating this to a separate class <code>DailyFratzeProvider</code> testing the job on it&#8217;s own its easy.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section-technical-risks"><a class="link" href="#section-technical-risks">11. Technical Risks</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>biking2</em> has been up and running for nearly 2 years now, the architecture contains no known risk for my usage scenario.</p>
</div>
<div class="paragraph">
<p>There is a possibility that the H2 database can be damaged due to an unexpected shutdown of the VM (that is OS or hardware failure). The risk is mitigated through regularly backups of the serialized database file.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="section-glossary"><a class="link" href="#section-glossary">12. Glossary</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. Glossar</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Synonym(s)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AngularJS</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/AngularJS">AngularJS</a> is an open-source web application framework mainly maintained by Google and by a community of individual developers and corporations to address many of the challenges encountered in developing single-page applications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache ActiveMQ</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/Apache_ActiveMQ">Apache ActiveMQ</a> is an open source message broker written in Java.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache License</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License</a> is a permissive Open Source license, especially designed for free software.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bootstrap</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://getbootstrap.com">Bootstrap</a> is the most popular HTML, CSS, and JS framework for developing responsive, mobile first projects on the web.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily Fratze</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">df, DF, DailyFratze</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An online community where users can upload a daily picture of themselves (a selfie, but the site did them before they where called selfies)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fat Jar</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A way of packaging Java applications into one single Jar file containing all dependencies, either repackaged or inside their original jars together with a special class loader.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gallery picture</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pictures from tours provided manually by the hours in addition to the pictures collected automatically from <em>Daily Fratze</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Garmin</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/Garmin">Garmin</a> develops consumer, aviation, outdoor, fitness, and marine technologies for the Global Positioning System.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPSBabel</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.gpsbabel.org">GPSBabel</a> is a command line utility that converts waypoints, tracks, and routes between popular GPS receivers such as Garmin or Magellan and mapping programs like Google Earth or Basecamp.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPS Exchange Format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPX, or GPS Exchange Format, is an XML schema designed as a common GPS data format for software applications. It can be used to describe waypoints, tracks, and routes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JaCoCo</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://eclemma.org/jacoco/">JaCoCo</a> is a code coverage library which can be used very easily from within NetBeans.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java 8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDK 8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The eight installment of the <a href="https://en.wikipedia.org/wiki/Java_(programming_language)">Java programmning language</a> and the first one to support functional paradigmns in the form Lambda expressions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQ Telemetry Transport</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/MQTT">MQTT</a> is a publish-subscribe based "light weight" messaging protocol for use on top of the TCP/IP protocol.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBeans</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://netbeans.org">NetBeans</a> is a free and open Source IDE that fits the pieces of modern development together.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OAuth</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/OAuth">OAuth</a> is an open standard for authorization. OAuth provides client applications a 'secure delegated access' to server resources on behalf of a resource owner.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">oEmbed</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="http://oembed.com">oEmbed</a> protocol is a simple and lightweight format for allowing an embedded representation of an URL on third party sites.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rich Site Summary,
                                Really Simple Syndication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/RSS">RSS</a> uses a family of standard web feed formats to publish frequently updated information: blog entries, news headlines, audio, video</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single Page Application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Boot</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://projects.spring.io/spring-boot/">Spring Boot</a> makes it easy to create stand-alone, production-grade Spring based Applications that you can "just run".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Data JPA</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://projects.spring.io/spring-data-jpa/">Spring Data JPA</a>, part of the larger Spring Data family, makes it easy to easily implement JPA based repositories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STOMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Simple Text Oriented Messaging Protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://stomp.github.io">STOMP</a> provides an interoperable wire format so that STOMP clients can communicate with any STOMP message broker to provide easy and widespread messaging interoperability among many languages, platforms and brokers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Training Center XML (TCX) is a data exchange format introduced in 2007 as part of Garmin&#8217;s Training Center product.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_about_this_template"><a class="link" href="#_about_this_template">About this template</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><a class="image" href="http://github.com/arc42"><img src="img/arc42-logo.png" alt="arc42"></a></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#169; This document uses material from the <a href="http://arc42.de" target="_blank">arc42 architecture
template</a>, freely available at <a href="http://github.com/arc42" target="_blank">http://github.com/arc42</a>.
</p><p class="tableblock"><span class="small">This material is open source and provided under the Creative Commons Sharealike 4.0 license.
It comes <strong>without any guarantee</strong>. Use on your own risk.
arc42 and its structure by Dr. Peter Hruschka and Dr. Gernot Starke.
Asciidoc version initiated by Markus Schärtel and Jürgen Krey,
completed and maintained by Ralf Müller and Gernot Starke.</span></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="link" href="#api">Appendix A: Api</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="bikes"><a class="link" href="#bikes">Bikes</a></h3>
<div class="sect3">
<h4 id="listing-bikes"><a class="link" href="#listing-bikes">Listing bikes</a></h4>
<div class="paragraph">
<p>A <code>GET</code> request will list all of the service&#8217;s bikes.</p>
</div>
<div class="sect4">
<h5 id="_request_parameter"><a class="link" href="#_request_parameter">Request Parameter</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/get/request-parameters.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="bike-structure"><a class="link" href="#bike-structure">Response structure</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/get/response-fields.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_request"><a class="link" href="#_example_request">Example request</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/get/curl-request.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_response"><a class="link" href="#_example_response">Example response</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/get/http-response.adoc[]</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_bike"><a class="link" href="#_creating_a_bike">Creating a bike</a></h4>
<div class="paragraph">
<p>A <code>POST</code> request is used to create a new bike</p>
</div>
<div class="sect4">
<h5 id="_request_structure"><a class="link" href="#_request_structure">Request structure</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/post/request-fields.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_request_2"><a class="link" href="#_example_request_2">Example request</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/post/curl-request.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_response_2"><a class="link" href="#_example_response_2">Example response</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/post/http-response.adoc[]</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_milages_to_bikes"><a class="link" href="#_adding_milages_to_bikes">Adding milages to bikes</a></h4>
<div class="paragraph">
<p>A bike manages its total milage at a given date. To make it easy for the user, no difference needs to be calculated, the user can enter the milage of is bike as stated on the odometer or whatever.</p>
</div>
<div class="paragraph">
<p>A <code>POST</code> request will add a new milage to a given bike.</p>
</div>
<div class="sect4">
<h5 id="_path_parameters"><a class="link" href="#_path_parameters">Path Parameters</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/milages/post/path-parameters.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_structure_2"><a class="link" href="#_request_structure_2">Request structure</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/milages/post/request-fields.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_request_3"><a class="link" href="#_example_request_3">Example request</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/milages/post/curl-request.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_response_3"><a class="link" href="#_example_response_3">Example response</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/milages/post/http-response.adoc[]</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_a_story_to_a_bike"><a class="link" href="#_adding_a_story_to_a_bike">Adding a story to a bike</a></h4>
<div class="paragraph">
<p>Bikes can have an associated story, how they were build or whatever.</p>
</div>
<div class="paragraph">
<p>A <code>PUT</code> request will update a given bike with a new story.</p>
</div>
<div class="sect4">
<h5 id="_path_parameters_2"><a class="link" href="#_path_parameters_2">Path Parameters</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/story/put/path-parameters.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_request_structure_3"><a class="link" href="#_request_structure_3">Request structure</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/story/put/request-fields.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_request_4"><a class="link" href="#_example_request_4">Example request</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/story/put/curl-request.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_response_4"><a class="link" href="#_example_response_4">Example response</a></h5>
<div class="paragraph">
<p>The reponse is an updated <a href="#bike-structure">bike</a>.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/story/put/http-response.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_deleting_a_story"><a class="link" href="#_deleting_a_story">Deleting a story</a></h5>
<div class="paragraph">
<p>An empty <code>PUT</code> request deletes a bikes story:</p>
</div>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/story/put-empty/curl-request.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/bikes/story/put-empty/http-response.adoc[]</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trips"><a class="link" href="#trips">Trips</a></h3>
<div class="paragraph">
<p>To keep track of all milage including time not spent on persistent bikes, the user can store assorted trips. A trip is a distance covered at a certain date.</p>
</div>
<div class="sect3">
<h4 id="_creating_a_trip"><a class="link" href="#_creating_a_trip">Creating a trip</a></h4>
<div class="paragraph">
<p>A <code>POST</code> request is used to create a new trip</p>
</div>
<div class="sect4">
<h5 id="_request_structure_4"><a class="link" href="#_request_structure_4">Request structure</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/trips/post/request-fields.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_request_5"><a class="link" href="#_example_request_5">Example request</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/trips/post/curl-request.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_response_structure"><a class="link" href="#_response_structure">Response structure</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/trips/post/response-fields.adoc[]</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_response_5"><a class="link" href="#_example_response_5">Example response</a></h5>
<div class="paragraph">
<p>Unresolved directive in appendix-api.adoc - include::/home/freddy/dev-for-rehman/sstradingreport/target/generated-snippets/api/trips/post/http-response.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-02-06 11:49:41 -05:00
</div>
</div>
</body>
</html>